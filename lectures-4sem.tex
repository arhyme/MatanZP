\documentclass[a5paper]{article}
\usepackage[cm]{fullpage}
\usepackage{cmap}
\usepackage[T2A]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english,russian]{babel}
\usepackage{amsmath,amssymb,amsthm}
\usepackage{hyperref}
\usepackage{enumitem} 
\usepackage{euscript}
\usepackage{icomma}


\newlist{enum}{enumerate}{10}
\setlist[enum]{label*=\arabic*.}
\usepackage{tikz}
\usetikzlibrary{positioning,arrows,shapes}

\newlist{sectenum}{enumerate}{10}
\setlist[sectenum]{
  label=\arabic{section}.\arabic{*}
}

\newcommand*{\hm}[1]{#1\nobreak\discretionary{}
	{\hbox{$\mathsurround=0pt #1$}}{}}

\newcounter{through}

\theoremstyle{plain}
\newtheorem{theorem}[through]{Теорема}
\newtheorem{corollary}[through]{Следствие}
\newtheorem{lemma}[through]{Лемма}
\newtheorem{task}[through]{Задача}

\theoremstyle{definition}
\newtheorem{definition}[through]{Определение}
\newtheorem{example}[through]{Пример}

\numberwithin{through}{section}
\numberwithin{equation}{section}

\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\rank}{rank}

\hypersetup{
  pdftitle={lecture-4sem},
  pdfauthor={},
  colorlinks=true,
  linkcolor=blue
}

\begin{document}
	
	\selectlanguage{russian}
	
	\title{Лекции \\
	по математическому анализу:\\
	многообразия, дифференциальные формы}
	\maketitle
	
	\begin{abstract}
		Записки создавались студентами Механико-математического факультета НГУ 
		с лекций, прочитанных С. Г. Басалаевым.
	\end{abstract}

\clearpage
\tableofcontents

\clearpage


\section{Многообразия}

\subsection{Многообразия без края}

\begin{definition}
	\label{ManifoldNoBoundary}
	Множество $M \in \mathbb{R}^n$ называется $C^r$-гладким $k$-мерным
	многообразием  без края, если для каждого $x_0 \in M$ существует $U$ - окрестность 
	$x_0$ и существует $ C^r$-диффеоморфизм $\Phi : U \to \Phi (U)$, такой что 
	$\Phi(x_0)=0$ и $\Phi(U \cap M) = V \times \{0\}^{n-k}$, где $V$ - окрестность нуля в $R^n$.
\end{definition}

При $r = 0$ многообразие называется топологическим, при $r > 0$ многообразие называется дифференцируемым.


Виды многообразий:
\begin{enumerate}	
	\item
	Набор изолированных точек $(k = 0)$.
	
	\begin{center}
		\begin{tikzpicture}
		\filldraw [black] (0.89,0.12) circle (2pt);
		\filldraw [black] (0.48,0.76) circle (2pt);
		\filldraw [black] (0.48,0.26) circle (2pt);
		\filldraw [black] (1,0.6) circle (2pt);
		\filldraw [black] (0, 0.5) circle (2pt);
		\draw [red] (0,0.5) circle (6pt);
		\end{tikzpicture}	
	\end{center}
	
	
	\item
	Набор кривых, в том числе с выколотыми концами, а также замкнутые ($k = 1$).
	\begin{center}
		\begin{tikzpicture}
		\draw (0,0) .. controls (1,-1) and (2,-1) .. (3,-1);
		\filldraw [white] (0,0) circle (3pt)
		(3,-1) circle (3pt);
		\draw [gray] (0,0) circle (3pt)
		(3,-1) circle (3pt);
		\end{tikzpicture}
	\end{center}
	\item
	Поверхности ($k = 2$).
	
	\begin{center}
		\begin{tikzpicture}
		\draw (0,0) circle (1.5cm);
		\draw (-1.5,0) arc (180:360:1.5 and 0.6);
		\draw[dashed] (1.5,0) arc (0:180:1.5 and 0.6);
		\fill[fill=black] (0,0) circle (1pt);
		\end{tikzpicture}
	\end{center}
	
\end{enumerate}

\begin{example}
	\
	\begin{itemize}
		\item 
		Пара параллельных прямых -- многообразие,
		\item 
		Пара непересекающихся плоскостей -- многообразие,
		\item 
		Плоскость и прямая -- не многообразие, так как их размерности не совпадают,
		\item 
		Пара пересекающихся прямых с выколотой точкой пересечения -- многообразие.
		\begin{center}
			\begin{tikzpicture}
			\draw (0,0) -- (4,2);
			\draw (4,0) -- (0,2);
			\filldraw (2,1) [white] circle (4pt);
			\draw (2,1) [red] circle (4pt);
			\end{tikzpicture}
		\end{center}
		
		
	\end{itemize}
	
\end{example}

Теперь рассмотрим способы задания $k-$мерных многообразий.

\begin{theorem}%[Об открытом множестве]% 
	\label{OpenSetManifold}
	Пусть $U \subseteq \mathbb{R}^n$ -- окрытое множество, тогда $U$ является 
	$n$-мерным многообразием.
\end{theorem} 
\begin{proof}
	Напомним, что множество называется \textit{открытым}, если для любая его точка $x_0$ лежит в некоторой окрестности.\\
	Отображение $\Phi$ можно определить следующим образом:
	$\Phi(x)=x-x_0$ -- сдвиг в ноль, переводит окрестность $x_0$ в окрестность нуля.
\end{proof}

\begin{theorem}[О графике]
	Пусть $U \subset \mathbb{R}^n$ -- открытое множество, $f: U \to \mathbb{R}, f \in C^r$, тогда график этой функции $\Gamma_f = 
	\{ (x, f(x))  \mid x \in U \}$ - $C^r$-гладкое $n$-мерное многообразие в $R^{n+1}$.
\end{theorem}

\begin{proof}
	Определим отображение $\Phi : U \times \mathbb{R} \to U \times \mathbb{R}$ следующим образом $\Phi(x, y) = (x, y - f(x))$, тогда:
	
	$\Phi(x_1, \ldots, x_n, y) = 
	\begin{pmatrix}
	x_1 \\
	\vdots \\
	x_n \\
	y - f(x_1, \ldots, x_n)
	\end{pmatrix} \quad
	\left| D \Phi \right|=
	\begin{vmatrix}
	E& 0 \\
	-\frac{\partial f}{\partial x_i} & 1
	\end{vmatrix}
	= 1
	$
	
	Отображение $\Phi$ является $C^r$-диффеоморфизмом и $\Phi(x,f(x)) = (x, 0)$, т.е. $\Phi(\Gamma_f) = U \times \{0\}$
\end{proof}

\begin{theorem}[О локальном вложении]
	Пусть $U \subset \mathbb{R}^k$ - открытое множество, $f: U \to \mathbb{R}^n, f \in C^r$ и $k \leq n $. Тогда, если $t^0 \in U и \rank Df(t^0)) = k$, то существует $U$-окрестность $t^0$, такая что $f(U)$ является $C^r$-гладким $k$-мерным многообразием.
\end{theorem}

\begin{proof}
	Так как $\rank Df(t^0) = k$, следовательно набор векторов $\{ \frac{\partial f}{ \partial x_1}, \ldots, \frac{\partial f}{\partial x_k}\}$  является линейно независимым, т.е. его можно дополнить до базиса $\mathbb{R}^n$.
	
	Пусть $\{ \frac{\partial f}{ \partial x_1}, \ldots, \frac{\partial f}{\partial x_k}\, v_{k+1}, \ldots, v_n\}$ - базис в $\mathbb{R}^n$.
	
	Определим $\Phi : U \times \mathbb{R}^{n-k} \to \mathbb{R}^n$ так, что $\Phi(t_1, \ldots, t_k, s_{k+1}, \ldots, s_n)=f(t_1, \ldots, t_k) +s_{k+1}v_{k+1} + \ldots + s_n v_n$.
	
	$D \Phi = [ \frac{\partial f}{ \partial x_1}, \ldots, \frac{\partial f}{\partial x_k}\, v_{k+1}, \ldots, v_n]$, следовательно $\det D \Phi \not= 0$.
	
	По теореме об обратной функции существует $W$ - окрестность $(t_0, 0)$, такая что $\Phi : W \to \Phi(W) - C^r$-диффеоморфизм. Выберем $V \times (-h, h) \in W$, так что $V$ - окрестность $x_0$ в $\mathbb{R}^k$, тогда $\Phi^{-1}(f(V))=V\times{0}^{n-k}$.
	
\end{proof}

\begin{definition}
	Пусть $x^0$ - решение системы уравнений:
	
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\end{cases}
	\end{equation*}
	тогда $x^0$ называется регулярным, если 
	$\rank \, \frac{\partial f_i}{\partial x_j} (x^0) = k$.
\end{definition}

\begin{theorem}[О решении системы уравнений]
	Пусть $U \subset \mathbb{R}^k$ - открытое множество, $f_1, \ldots, f_k : 
	U \to \mathbb{R}$ и $f_i \in C^r \; \forall \, i \leq k$, тогда множество регулярных решений системы уравнений
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\end{cases}
	\end{equation*}
	представляет собой $C^r$-гладкое $(n-k)$-мерное многообразие.
\end{theorem}
\begin{proof}	
	Пусть $x^0$ - регулярное решение, тогда:
	
	\begin{equation*}
	D f(x^0) = \begin{pmatrix}
	\frac{\partial f_1}{ \partial x_1}& \ldots& \frac{\partial f_1}{ \partial x_n} \\
	\vdots& \quad& \vdots \\
	\frac{\partial f_k}{ \partial x_1}& \ldots& \frac{\partial f_k}{ \partial x_n}
	\end{pmatrix} (x^0)
	\end{equation*}
	
	Матрица состоит из $n$ столбцов, где $k$ из них линейно независимы.
	
	%$f(x,y) = 0$, $\det \frac{\partial f}{ \partial y} \not= 0 \implies в некоторой окрестности y=g(x)$.%
	
	
	В некоторой окрестности $x^0$:	
	
	$x_{n-k+1} = g_{n-k+1}(x_1, \ldots, x_{n-k})$
	
	$\ldots$
	
	$x+n = g_n(x_1, \ldots, x_{n-k})$
	
	Множество решений по теореме о локальном вложении является многообразием:
	
	$x_1=x_1$
	
	$\ldots$
	
	$x_k=x_k$
	
	$x_{n-k+1} = g_{n-k+1}(x_1, \ldots, x_{n-k})$
	
	$\ldots$
	
	$x+n = g_n(x_1, \ldots, x_{n-k})$
	
\end{proof}

\subsection{Многообразия с краем}

\begin{definition}
	$\mathbb{R}_+^k = \{(x_1, \ldots, x_k) : x_k > 0\}$ - верхнее полупространство ($\mathbb{R}_-^k = \{(x_1, \ldots, x_k) : x_k < 0\}$ - нижнее полупространство).
\end{definition}

\begin{definition}
	Пусть $V \subseteq R^k$ - окрестность нуля, тогда $V \cap \mathbb{R}_+^k$ называется полуокрестностью нуля. В ее основании лежит $(k-1)$-мерная окрестность нуля.
\end{definition}

\begin{definition}
	\label{ManifoldWithBoundary}
	
	Множество $M \in \mathbb{R}^n$ называется $C^r$-гладким $k$-мерным
	многообразием с краем, если для каждого $x_0 \in M$ существует $U$ - окрестность $x_0$ и существует $ C^r$-диффеоморфизм $\Phi : U \to \Phi (U)$, такой что $\Phi(x_0)=0$ и, либо $\Phi(U \cap M) = V \times \{0\}^{n-k}$ (тогда $x_0$ - внутреняя точка), либо 
	$\Phi(U \cap M) = (V \cap \mathbb{R}_+^k ) \times \{0\}^{n-k}$ (тогда 
	$x_0$ - крайняя точка).
	
\end{definition}


Примеры многообразий с краем:

\begin{enumerate}	
	\item
	Края нет при $k = 0$
	
	\item
	Край незамкнутой кривой $(k = 1)$ - это ее концевые точки. У замкнутых и неограниченных кривых края нет.
	\begin{center}
		\begin{tikzpicture}
		\draw (0,0) .. controls (1,-1) and (2,-1) .. (3,-1);
		\filldraw [blue] (0,0) circle (2pt)
		(3,-1) circle (2pt)
		(1.8,-0.925) circle (2pt);
		\draw [red] (1.8,-0.925) circle (5pt);
		
		\end{tikzpicture}
	\end{center}
	\item
	При $k = 2$, внутренними точками поверхности являются те, которые лежат внутри нее вместе со своей некоторой окресности, остальные являются краевыми.
	
	
	
\end{enumerate}

\begin{definition}
	Пусть $M$- многообразие, тогда $\partial M = \{x \mid x$ - краевая точка $M\}$ - множество краевых точек многообразия $M$.
\end{definition}

\begin{theorem}[О крае]
	Пусть $M$ - $C^r$-гладкое $k$-мерное многообразие с краем, тогда множество его краевых точек $\partial M$ является $C^r$-гладким $k$-мерным многообразием без края ($\partial \partial M = \emptyset$).
\end{theorem}

\begin{proof}
	Пусть $x \in \Phi(U \cap M)$, тогда $x=(x_1, \ldots, x_{k-1}, x_k, 0, \ldots, 0)$. %Если $x_k > 0$, то $x$ - внутреняя точка многообразия.%
	Если $x_k = 0$, то $x \in \partial M$ - краевая точка. Отображение $\Phi$ переводит все краевые точки $U \cap M$ в $(k-1)$-мерную плоскость (основание полупространства). Основание - $(k-1)$-мерная окрестность нуля, следовательно $\Phi(U \cap M) = W \times \{0\} \times \{0\}^{n-k}$ - выполнено определение многообразия.
\end{proof}

\begin{theorem}[О решении системы уравнений и неравенства]
	Пусть $U \subset \mathbb{R}^k$ - открытое множество, $f_1, \ldots, f_{k+1} : 
	U \to \mathbb{R}$, $f_i \in C^r \; \forall \, i \leq k$ и $\rank \, \frac{\partial f_i}{\partial x_j} (x^0) = k + 1$,  тогда множество регулярных решений системы уравнений
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\\
	f_{k+1}(x_1, \ldots, x_n) \geq a_{k+1}
	\end{cases}
	\end{equation*}
	представляет собой $C^r$-гладкое $(n-k)$-мерное многообразием с краем (внутрение точки - решение строгого неравенства, край - решение $(k+1)$ уравнений).
\end{theorem}
\begin{proof}
	Решение неравенства $f_{k+1}(x_1, \ldots, x_n) > a_{k+1}$ является открытым множеством, и по теореме \ref{OpenSetManifold} задает многообразие.
	
	Решение системы уравнений 
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\\
	f_{k+1}(x_1, \ldots, x_n) = a_{k+1}
	\end{cases}
	\end{equation*}
	
	задает $(k-1)$ мерную поверхность - край многообразия.
\end{proof}

\begin{definition}
	Множество $M \in \mathbb{R}^k$ называется $k$-мерным кусочно-гладким многообразием, если:
	\begin{enumerate}
		\item $M$ -- $k$-мерное топологическое многообразие.
		\item Существует разбиение $M = \tilde{M} \cup (\bigcup_{i=0}^{n} Z_i) $, такое что $\tilde{M}$ - гладкое $k$-мерное многообразие, а $Z_i$ - кусочно гладкие многообразия размерности $l \leq k - 1$.
	\end{enumerate}
\end{definition}

\begin{example}
	Куб.
	\begin{center}
		
		\begin{tikzpicture}
			\coordinate (O) at (0,0,0);
			\coordinate (A) at (0,2,0);
			\coordinate (B) at (0,2,2);
			\coordinate (C) at (0,0,2);
			\coordinate (D) at (2,0,0);
			\coordinate (E) at (2,2,0);
			\coordinate (F) at (2,2,2);
			\coordinate (G) at (2,0,2);
			
			\draw[blue,fill=orange!80] (O) -- (C) -- (G) -- (D) -- cycle;% Bottom Face
			\draw[blue,fill=blue!30] (O) -- (A) -- (E) -- (D) -- cycle;% Back Face
			\draw[blue,fill=red!10] (O) -- (A) -- (B) -- (C) -- cycle;
			\draw[blue,fill=red!20,opacity=0.8] (D) -- (E) -- (F) -- (G) -- cycle;
			\draw[blue,fill=red!20,opacity=0.6] (C) -- (B) -- (F) -- (G) -- cycle;
			\draw[blue,fill=red!20,opacity=0.8] (A) -- (B) -- (F) -- (E) -- cycle;
			
			\coordinate [label=left:\textcolor{blue}{\text{вершины}}]
			(V) at (-1.5,-1);
			\draw[->] (V) -- (C) ;
			\draw[->] (V) -- (B);
			\draw[->] (V) -- (A);
			
			\coordinate [label=left:\textcolor{blue}{\text{ребра}}]
			(R) at (5.1,2);
			\draw[->] (4,2) -- (2,2,1);
			\draw[->] (4,2) -- (2,1,0);
			\draw[->] (4,2) -- (2,0,1);
			
			\coordinate [label=left:\textcolor{blue}{\text{ребра}}]
			(H) at (5.1,2);

		\end{tikzpicture}
	\end{center}
	
\end{example}

\begin{theorem}
	Пусть $U \subset \mathbb{R}^k$ - открытое множество, $f_1, \ldots, f_{k}, \ldots ,f_{k+l} : 
	U \to \mathbb{R}$, $f_i \in C^r \; \forall \, i \leq k + l$ и $\rank \, \frac{\partial f_i}{\partial x_j} (x^0) = k + l$,  тогда множество регулярных решений системы уравнений
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\\
	f_{k+1}(x_1, \ldots, x_n) \geq a_{k+1}
	\\
	\ldots
	\\
	f_{k+l}(x_1, \ldots, x_n) \geq a_{k+l}
	\end{cases}
	\end{equation*}
	представляет собой $C^r$-гладкое $(n-k)$-мерное многообразием с краем.
\end{theorem}

\begin{example}
	в $\mathbb{R}^3$. $x^2+y^2\leq 1, x\geq 0, z\geq 0, z\leq 1$
	
	\begin{center}
		
		\begin{tikzpicture}[->]
		\draw (0,0) -- (xyz cs:x=4);
		\draw (0,0) -- (xyz cs:y=4.5);
		\draw (0,0) -- (0.52,-1.06,1.6);
		\draw (1.25,0) arc(0:-92:1.25 and 0.5);
		\draw (1.25,0) arc(0:90:1.25 and 0.5);
		
		\draw (1.25,3.5) arc (0:-90:1.25 and 0.5);
		\draw [dashed] (1.25,3.5) arc (0:-90:1.25 and -0.5);
		\draw (1.25,3.5) -- (1.25,0);  
		
		\fill [opacity =0.6, color = blue] (1.25, 0) -- (1.25, 3.5) 
		arc(0:-90:1.25 and 0.5) -- (0, -0.5) node[midway, right, color =black]{} arc(270:360:1.25 and 0.5) ;
		\end{tikzpicture}

		
	\end{center}
-- грань тела, $2$-мерное многообразие.

\end{example}


\subsection{Касательное и нормальное пространства}

\begin{definition}
	Пусть $\gamma : [a, b] \to \mathbb{R}^n \in C^1$, тогда вектор $\gamma'(t) \in \mathbb{R}^n$ называется вектором скорости кривой $\gamma$.
\end{definition}

\begin{definition}
	Вектор $\vec{v} \in \mathbb{R}^n$ называется касательным к множеству 
	$M \subseteq \mathbb{R}^n$ в точке $x_0 \in M$, если это вектор скорости некоторой кривой, лежащей в $M$, т.е. существует кривая
	$\gamma : [0, \varepsilon] \to M$, такая что $\gamma(0) = x_0$ и $\gamma_t'(0) = \vec{v}$.
\end{definition}

Множество касательных векторов к $M$ в точке $x_0$ обозначается $T_{x_0}M$.

\begin{task}
	Пусть $\gamma : (a, b) \to \mathbb{R}^n$ - параметризованная кривая, $\varPsi : \mathbb{R}^n \to \mathbb{R}^n$ - $C^1$-диффеоморфизм. Показать, что если $v$ - вектор скорости кривой $\gamma$ в точке $t_0 \in (a,b)$, то $d \varPsi_{\gamma(t_0)} \langle v \rangle$ - вектор скорости кривой $\Gamma = \varPsi \circ \gamma$ в точке $t_0$.
\end{task}

\begin{proof}[Решение]
	Воспользуемся правилом дифференцирования композиции:
	
	\begin{equation*}
		d(\varPsi \circ \gamma) \langle t_0 \rangle = d(\varPsi_{\gamma(t_0)}) \langle \gamma(t_0) \rangle = 
		d(\varPsi_{\gamma(t_0)}) \langle v \rangle
	\end{equation*}
\end{proof}

\begin{lemma}
	Колинеарный касательному вектору так же является касательным вектором, т.е. 
	если $\vec{v} \in T_{x_0}M$, то $\forall \lambda > 0 \; \lambda \vec{v} \in T_{x_0}M$.
\end{lemma}

\begin{proof}
	TODO
\end{proof}

\begin{theorem}[О множестве касательных векторов]
	Если $M \subseteq \mathbb{R}^n$ - $C^1$-гладкое $k$-мерное многообразие,
	$x_0 \in M$, тогда:
	
	\begin{enumerate}
		\item 
		Если $x_0 \in M \setminus \partial M$, то $T_{x_0}M \simeq 
		\mathbb{R}^k$.
		
		\item 
		Если $x_0 \in \partial M$, то $T_{x_0}M \simeq 
		\mathbb{R}_+^k$.
	\end{enumerate}
\end{theorem}

\begin{proof}
	По определению $k$-мерного многообразия, для каждого $x_0 \in M$ существует $U$ - окрестность $x_0$ и существует $ C^r$-диффеоморфизм $\Phi : U \to \Phi (U)$, такой что $\Phi(x_0)=0$ и $\Phi(U \cap M) = V \times \{0\}^{n-k}$, где $V$ - окрестность нуля в $R^n$.
	
	Под действием $\Phi$ кривая перейдет в кривую.
	
	$\gamma : [0, \varepsilon] \to M \implies \Gamma(t) = 
	\Phi(\gamma(t)) = (x_1(t), \ldots, x_k(t), 0, \ldots, 0) 
	\implies \Gamma'(t) = =(x'_1(t), \ldots, x'_k(t), 0, \ldots, 0)$.
	
	$\Gamma'(t) = \Phi(\gamma(t)) = D \Phi_{\gamma(t)} \langle\gamma'(t)\rangle$ -
	линейное отображение, такое, что $\det D \Phi \not = 0$.
	
	$T_{x_0}M = D \Phi^{-1} (\mathbb{R}^k \times \{0\}^{n-k}) \implies T_{x_0}M$ - $k$-мерная плоскость (т.к. дифференциал переводит плоскость в плоскость). 
\end{proof}

\begin{definition}
	Нормальное пространство $N_{x_0}M$ к дифференцируемому многообразию в точке $x_0$ -- это ортогональное дополнение к касательному пространству $T_{x_0}M$.
\end{definition}

\begin{lemma}
	Пусть $M \subset \mathbb{R}^n$ и $x_0 \in M$, тогда $\dim M = k$, 
	$\dim T_{x_0}M = k$, $\dim N_{x_0}M = n - k$.
\end{lemma}

\begin{theorem}[О базисе касательного пространства]
	Пусть $U \subset \mathbb{R}^k$ - открытое множество, $f : U \to \mathbb{R}^k$, $f \in C^r$. Тогда, если $M = f(U)$ - многообразие и $\rank Df = k$, то $\{\frac{\partial f}{\partial x_1} (t_0), \ldots, \frac{\partial f}{\partial x_k} (t_0) \}$ - базис в $T_{f(t_0)}M$.
\end{theorem}

\begin{proof}
	Пусть $t_0 \in U$, определим $\Gamma_j = t_0 + t \cdot \vec{e_j}$, тогда 
	$\gamma_j(t)=f(\Gamma_j(t))$ - кривая на многообразии.
	
	Найдем её касательный вектор в точке $t_0$: $\gamma_j'(t_0) = 
	\frac{d}{dt} f(t_0 + t \cdot \vec{e_j}) = \frac{\partial f}{\partial t_j}(t_0) \in T_{f(t_0)}M$.
	
	Набор векторов $\left\{\frac{\partial f}{\partial t_i}\right\}_{i=1}^{k}$ является линейно независимым и их количество равно размерности касательного пространства.
\end{proof}

\begin{theorem}
	Пусть многообразие $M$ задано системой уравнений:
	\begin{equation*}
	\begin{cases}
	f_1(x_1, \ldots, x_n) = a_1
	\\
	\ldots
	\\
	f_k(x_1, \ldots, x_n) = a_k
	\end{cases}
	\end{equation*}
	и $f_1, \ldots, f_k : U \to \mathbb{R}$, $f_i \in C^r \; \forall \, i \leq k$ , $U \subseteq \mathbb{R}^n$ -- открытое множество, а так же $\rank (\frac{\partial f_i}{\partial x_j})=k$, тогда система уравнений
	\begin{equation*}
	\begin{cases}
	df_1(x_0)\langle\vec{v}\rangle = 0
	\\
	\ldots
	\\
	df_k(x_0)\langle\vec{v}\rangle = 0
	\end{cases}
	\end{equation*}
	задает $T_{f(t_0)}M$, а $\{\nabla f_1(x_0), \ldots, \nabla f_k(x_0)\}$ базис в $N_{x_0}M$.
\end{theorem}

\begin{proof}
	Пусть $x_0 \in M$. Возьмем вектор $\vec{v} \in T_{f(t_0)}M$, тогда по определению существует кривая $\gamma : [0, \varepsilon] \to M$, такая что $\gamma(0) = x_0$ и $\gamma_t'(0) = \vec{v}$.
	
	$f(\gamma(t)) = 0 \implies 0=f(\gamma(t))'=df_{f(t)}\langle\gamma'(t)\rangle$.
	
	Подставим $t=0 \implies 0 = df_{x_0}\langle\vec{v}\rangle$. Из этого равенства следует, что: 
	
	\begin{equation*}
	\begin{cases}
	df_1(x_0)\langle\vec{v}\rangle = 0
	\\
	\ldots
	\\
	df_k(x_0)\langle\vec{v}\rangle = 0
	\end{cases}
	\end{equation*}
	
	Заметим, что $0 = df_{x_0}\langle\vec{v}\rangle = \nabla f_j(x_0) \cdot \vec{v}$, из чего получаем, что 
	\\
	$\{\nabla f_1(x_0), \ldots, \nabla f_k(x_0)\}$ -- базис в $N_{x_0}M$, т.к. $T_{f(t_0)}M \perp N_{x_0}M$.
\end{proof}

\subsection{Задача на условный экстремум}

\begin{definition}
	Пусть $M, N$ -- дифференцируемые многообразия, тогда $f : M \to N$ дифференцируема в точке $x_0$, если существует линейное отображение $L : T_{x_0}M \to T_{f(t_0)}N$, такое что для каждой кривой $\gamma : [0, \varepsilon] \to M$, такой что $\gamma \in C^1$, $\gamma(0)=x_0$, $\gamma'(0)=\vec{v} \in T_{x_0}M$, выполняется $f(\gamma(t)) = f(x_0) + tL(\vec{v}) + o(t)$.
\end{definition}

\begin{theorem}[Необходимое условие экстремума]
	Пусть $f: M \to \mathbb{R}$ - дифференцируема и $x_0$ - её экстремум, тогда $df(x_0) = 0$.
\end{theorem}

\begin{proof}
	Пусть $\vec{v} \in T_{x_0}M \Longleftrightarrow \exists $ кривая $\gamma : [0, \varepsilon] \to M$, такая что $\gamma(0) = x_0$ и $\gamma_t'(0) = \vec{v}$.
	
	Для $f \mid_{\gamma} x_0$ - экстремум, следовательно $f(\gamma(t))'(0)=0=df_{x_0}\langle\vec{v}\rangle$.
\end{proof}

Пусть $f: U \to \mathbb{R}$, $U \subseteq \mathbb{R}^n$ -- открытое множество, $M \subseteq U$ - $k$-мерное многообразие. Ставится задача: найти экстремум на многообразии $f\mid_{M}$.

\begin{theorem}[Необходимое условие условного экстремума]
	Если $x_0 \in M$ -- точка экстремума $f$, то $df\mid_{T_{x_0}M} = 0 \Leftrightarrow \nabla f(x_0) \in N_{x_0}M$.
\end{theorem}

\begin{proof}
	Пусть $\vec{v} \in T_{x_0}M \Longleftrightarrow \exists $ кривая $\gamma : [0, \varepsilon] \to M$, такая что $\gamma(0) = x_0$ и $\gamma_t'(0) = \vec{v}$.
	
	Тогда $x_0$ - экстремум $f(\gamma(t))$ и $f(\gamma(0)) = 0$. Заметим, что $f(\gamma(t))= df_{\gamma(0)}\langle \gamma'(0)\rangle=df_{x_0} \langle \vec{v} \rangle$.
\end{proof}

\begin{theorem}[Метод множителей Лагранжа]
	Пусть $f, \varphi_1, \ldots, \varphi_k : U \to \mathbb{R}$, $U \subseteq \mathbb{R}^n$. Тогда, если $x_0$ - условный экстремум при условиях $\varphi_1(\bar{x}) = 0, \ldots, \varphi_k(\bar{x})  = 0$, то $dL(x_0) = 0$, где $L(\bar{x}, \lambda_1, \ldots, \lambda_k)=f(\bar{x}) - \lambda_1\varphi_1(\bar{x}) - \ldots - \lambda_k\varphi_k(\bar{x})$ -- функция Лагранжа.
\end{theorem}

\begin{proof}
	Рассмотрим $L(\bar{x}, \lambda_1,\ldots,\lambda_k)$. $\frac{\partial L}{\partial \lambda_j}(x) = - \varphi_j(x) = 0 \Rightarrow x$ -- решение системы уравнений. 
	
	Возьмем частную производную $L$ по $x_j$:
	\[ \frac{\partial L}{\partial x_j} (x, \lambda) = \frac{\partial f}{\partial x_j}(x) - 
	\lambda_1\frac{\partial \varphi_1}{\partial x_j}(x) - 
	\ldots - \lambda_k \frac{\partial \varphi_n}{\partial x_j}(x) = 0, \]
	отсюда $\nabla f(x) = \lambda_1\nabla\varphi_1(x) + \ldots +
	\lambda_k\nabla\varphi_k(x) $ -- градиенты $\nabla\varphi_i$ -- это нормали, следовательно, их линейная комбинация тоже нормаль. Таким образом, $\nabla f$ -- нормаль к поверхности и выполнено необходимое условие условного экстремума.
	\end{proof}


% лекция 26.02

\begin{lemma}[Правило дифференцирования вдоль кривой] 
	\label{CurveDiffRule}
	\
	
	Пусть $f: U \to \mathbb{E} \in C^2, U \subseteq \mathbb{R}^n$ -- открытое множество 
	и $\gamma:[a, b] \to U \in C^2$ -- кривая. Тогда
	\begin{enumerate}
		\item 
		$(f\circ\gamma)'(t) = df_{\gamma(t)} \langle \gamma'(t)\rangle,$
		\item 
		$(f\circ\gamma)''(t) = d^2f_{\gamma(t)} \langle \gamma'(t), 
		\gamma'(t)\rangle + df_{\gamma(t)} \langle \gamma''(t) \rangle.$
	\end{enumerate}
\end{lemma}

	Есть два способа доказательства, здесь будет приведен самый оптимальный. Другой способ вы сможете найти в своих лекциях ;-)
\begin{proof}
	$(f \circ \gamma)''(t) = \left(df_{\gamma(t)}\langle \gamma'(t) \rangle\right)'_t $ -- дифференцирование сложной функции.
	
	Напомним, что $d_x\left(df_x\langle \vec{v}\rangle\right) = d^2f(x)\langle \vec{v} \rangle$ и
	$d_{\vec{v}} \left(df_x \langle \vec{v} \rangle\right) = df_x.$
	
	Отсюда имеем $\left( df_{\gamma(t)}\langle \gamma'(t)\rangle \right)'_t = 
	d^2f_{\gamma(t)} \langle \gamma'(t), \gamma'(t) \rangle + df_{\gamma(t)} \langle \gamma''(t) \rangle.$
	
\end{proof}

Теперь мы готовы сформулировать достаточное условие экстремума.

Перед доказательством заметим, что если $\varphi_1,\ldots, \varphi_n$ -- уравнения связи, то $x \in M$ (лежит в многообразии) тогда и только тогда, когда 
\begin{equation*}
\begin{cases}
\varphi_1(x) = 0,
\\
\ldots
\\
\varphi_n(x) = 0.
\end{cases}
\end{equation*}


\begin{theorem}[Достаточное условие экстремума в методе множителей Лагранжа]
	Пусть $U \subset \mathbb{R}^n$, $f, \varphi_1,\ldots, \varphi_k: U \to \mathbb{R} \in C^2$, 
	$\rank \left(\frac{\partial \varphi_i}{\partial x_j}\right) = k$ -- всюду, то функция Лагранжа 
	$L(x, \lambda_1,\ldots, \lambda_k) = f(x) - \lambda_1\varphi_1(x) - \ldots - \lambda_k \varphi_k(x) $
	если $dL(x_0,\lambda_0) = 0$, то при $d_x^2L(x_0, \lambda_0) > 0$ -- достигает минимума, при
	$d_x^2 L(x_0, \lambda_0) < 0 $ -- максимума.
\end{theorem}

\begin{proof}
	Пусть $dL(x_0,\lambda_0) = 0, d_x^2 L(x_0, \lambda_0)\mid_{T_{x}M\times T_{x}M} > 0$. 
	
	$ dL(x_0,\lambda_0) = 0 \iff \frac{\partial L}{\partial x} = 
	\frac{\partial f}{\partial x} - \sum_{j = 1}^{k} \lambda_j\frac{\partial \varphi}{\partial x_j} = 0
	\iff \nabla f(x_0) = \sum_{j = 1}^{k} \lambda_j\nabla\varphi_j.$ 
	Кроме того, $\frac{\partial L}{\partial x} = 0 = - \varphi_j \iff x_0 \in M$.
	Следовательно,  
	$\nabla f(x) \in N_{x_0}M \iff df_{x_0} \mid_{T_{x_0}M} = 0$.
	
	Возьмем произвольную $\gamma:(-\varepsilon, \varepsilon) \to M \in C^2, \gamma(0) = x_0$. 
	Посмотрим, как ведет себя функция $f$ на кривой $\gamma$, т.е. ограничение функции на эту кривую.
	
	Рассмотрим $f \circ \gamma : (-\varepsilon, \varepsilon) \to \mathbb{R}$. 
	По лемме \ref{CurveDiffRule} $(f\circ\gamma)'(t) = df_{\gamma(t)}\langle \gamma'(t)\rangle.$
	
	$(f \circ \gamma)'(0) = df_{x_0}\langle \gamma'(0)\rangle = 0$. 
	
	Поскольку образ кривой лежит в многообразии
	\begin{equation*}
	\gamma(t) = x \in M \iff
		\begin{cases}
		\varphi_1(\gamma(t)) \equiv 0, \\
		\ldots \\
		\varphi_k(\gamma(t)) \equiv 0.
		\end{cases}
	\end{equation*} 
	Подставим $\gamma(t) = x$ в $L(x, \lambda)$, получим
	\[ L(\gamma(t), \lambda) = f(\gamma(t)) - \lambda_1\varphi_1(\gamma(t)) - \ldots -
	\lambda_k\varphi_k(\gamma(t)) = f(\gamma(t)) \]
	далее,
	\[ (f \circ \gamma)''(t) = (L(\gamma(t), \lambda))'_{tt} =
	d_x^2 L\langle \gamma'(t), \gamma'(t) \rangle + d_x L\langle \gamma''(t) \rangle. \]
	подставим ноль
	\[ (f \circ \gamma)''(0) = d_x^2 L\langle \gamma'(0), \gamma'(0) \rangle + 0 > 0. \]
	Имеем, что $f \circ \gamma: (-\varepsilon, \varepsilon) \to \mathbb{R},
	 (f \circ \gamma)'(0) = 0, (f \circ \gamma)''(0) > 0$. 
	 Следовательно, $t = 0$ является точкой минимума для $f \circ \gamma$.
	 
	 Таким образом, $x_0$ -- точка минимума для любой кривой $\gamma \subseteq M$,
	 проходящей через $x_0$. Следовательно, $x_0$ -- точка минимума для $f\mid_{M}.$
\end{proof}

\begin{example}
	Найти экстремумы функции
	$f(x, y, z) = x^2 - 2x + y^2 - z^2$ на $x^2 + y^2 \leq 4, 0 \leq z \leq 1.$
\end{example}

% Лекция 28.02.19

\subsection{Площадь поверхности}

Пусть $v_1, \ldots, v_n \in \mathbb{R}^n$. Из прошлого семестра, мы знаем, что $n$-мерный объем параллелепипеда $\text{П} (v_1, \ldots, v_n)= \{ t_1 v_1 + \ldots, t_n v_n : t_i \in [0, 1] \}$, натянутого на набор векторов $v_1, \ldots, v_n \in \mathbb{R}^n$ может быть вычислен по формуле $|\text{П}| = | \det [v_1, \ldots, v_n] |$. Так же он может быть вычислен с помощью определителя матрицы Грамма, полагая $A = [v_1, \ldots, v_n]$, из $(\langle v_i, v_j \rangle)_{ij}=A^{T}A$ получаем: $\det A^{T}A = \det A^T \det A = (\det A)^2 = (| \text{П} |)^2$.

Вспомним так же, как изменяется мера при отображениях.

Пусть $L : \mathbb{R}^k \to \mathbb{R}^n$ - линейное отображение. Мы знаем, что для любого измеримого множества $E \subseteq \mathbb{R}^k$, мера его образа вычисляется по формуле $| L(E) | = J_L | E | = | \det L | | E |$.

Если же отображение $\varphi \in C^1$ не является линейным, мы можем приблизить его линейным и получить формулу локального искажения меры:

\begin{equation*}
J_{\varphi(x)} = \lim\limits_{r \to 0} \frac{| \varphi(Q(x,r) ) |}{| Q(x,r)) |} = | \det D \varphi(x) |
\end{equation*}

Из чего мы получаем, что для каждого измеримого множества $E$, мера его образа вычисляется по формуле $| \varphi(E) | = \int\limits_{E} J_{\varphi(x)}$.

Поскольку мы работаем не со всем пространством, мы можем расширить эти определения.

\begin{theorem}[Объем k-мерного параллепипеда]
	Пусть $v_1, \ldots, v_k \in \mathbb{R}^n, k \leq n$. Тогда $| \text{П} (v_1, \ldots, v_n) |_k = \sqrt{\det(\langle v_i, v_j \rangle)}$. Обозначив за $A = [v_1, \ldots, v_n]$, это выражение можно записать ввиде $| \text{П} | = \sqrt{\det A^* A}$.
\end{theorem}

\begin{proof}
	Пусть $k$-мерная гиперплоскость $L$ содержит в себе параллелепипед $\text{П}$.
	
	Существует ортогональное преобразование $Q : \mathbb{R}^n \to \mathbb{R}^n$, такое что $Q(L) = \mathbb{R}^k \times \{0\}^{n-k}$. Применим это преобразование к набору векторов, на которые натянут параллепипед: $Q(v_i)=(a_{1i}, \ldots, a_{kj}, 0, \ldots, 0)^T$.
	
	Заметим, что ортагональное преобразование не меняет объем.
	
	\begin{equation*}
		A = [v_1; \ldots; v_k] \quad QA = 
		\begin{pmatrix}
			\theta \\
			0
		\end{pmatrix} 
		\text{где} \; \theta -  k \times k \text{матрица}
	\end{equation*}
	
	Используя равенство $(QA)^* QA = \theta^* \theta$, получаем требуемое утверждение:
	
	\begin{equation*}
		|Q(\text{П})|_k=|\text{П}|_k=|\det \theta|=\sqrt{\det \theta^* \theta}=\sqrt{\det (QA)^* QA}=\sqrt{\det A^* A}
	\end{equation*}
\end{proof}

\begin{definition}
	Пусть $A$ -  матрица, имеющая из $n$ строк и $k$ столбцоц и $M(n,k) = \{I = (i_1, \ldots, i_k) \in \mathbb{N}^k : 1 \leq  i_1 < i_2 < \ldots < i_k \leq n \}$ - множество мультииндексов. Тогда $A_I$ - минор, составленный из $i_1, i_2, \ldots, i_k$ строк матрицы $A$.
\end{definition}

\begin{theorem}[Формула Бине-Коши]
	Пусть $A$ --  матрица, имеющая из $n$ строк и $k$ столбцов, тогда $\det A^* A = \sum\limits_{I \in M(n,k)}^{} \det^2 A_I$.
\end{theorem}

\begin{proof}
	Докажем более общее утверждение: пусть $A, B = (n, k)$-матрицы, тогда $\det A^* B = \sum\limits_{I \in M(n, k)} \det A_I \det B_I$.
	
	Пусть $A = [u_1; \ldots; u_n]$ и $B = [v_1, \ldots, v_n]$, определим отображения $L_1$ и $L_2$ следующим образом:
	
	\begin{equation*}
		L_1 \langle u_1, \ldots, u_k, v_1, \ldots, v_k \rangle = \det A^* B 
	\end{equation*}
	
	\begin{equation*}
		L_2 \langle u_1, \ldots, u_k, v_1, \ldots, v_k \rangle = \sum\limits_{I \in M(n, k)} \det A_I \det B_I
	\end{equation*}
	
	Заметим, что $L_1$ и $L_2$ линейны по каждому аргументу, следовательно, чтобы доказать, что $L_1=L_2$ достаточно доказать что они одинаково действуют на базис (TODO: ????).
	
	\begin{equation*}
	L_1 \langle e_{i1}, \ldots, e_{ik}, e_{j1}, \ldots, e_{jk} \rangle = \delta_{IJ} = L_2 \langle e_{i1}, \ldots, e_{ik}, e_{j1}, \ldots, e_{jk} \rangle
	\end{equation*}
\end{proof}

\begin{corollary}
	Пусть $L : U \subseteq \mathbb{R}^k \to \mathbb{R}^n$ - линейное отображение, такое, что $\rank L = k \leq n$. Тогда для каждого измеримого множества $A$, $L(A)$ - измеримо и $| L(A) |_k = J_L |A|_k$, где $J_L = \sqrt{\det L^* L}$.
\end{corollary}

\begin{corollary}
	Пусть $\text{П}$ -- $k$-мерная плоскость в $\mathbb{R}^n$ и $\varphi : \mathbb{R}^k \to \text{П}$ - $C^1$-диффеоморфизм. Тогда для каждого измеримого $E \subset \mathbb{R}^k$, $\varPi(E)$ - измеримо и $|\varphi(E)|_k=\int_{E}^{} J_{\varphi}(x)dx$, где $J_{\varphi} = \sqrt{\det D \varphi^* (x) D \varphi(x)}$.
\end{corollary}

Из формулы Коши-Бине так же можно получить выражения для скалярного и векторного произведения. 

К примеру, взяв за $A$ некоторый вектор $v \in \mathbb{R}^n$, можно получить:

\begin{equation*}
	v^T v = \langle v, v \rangle = |v|^2=\sum\limits_{i=1}^n v_i^2
\end{equation*}

Аналогично, если разместить векторы $u, v \in \mathbb{R}^3$ в столбцы матрицы $A$, получим (TODO: расписать это подробнее):

\begin{equation*}
	A^2 = 
	\begin{vmatrix}
		u_1 & v_1 \\
		u_2 & v_2 \\
	\end{vmatrix}
	+
	\begin{vmatrix}
	u_1 & v_1 \\
	u_2 & v_3 \\
	\end{vmatrix}
		+
	\begin{vmatrix}
	u_2 & v_2 \\
	u_3 & v_3 \\
	\end{vmatrix}
	= |u \times v|^2
\end{equation*}

Теперь мы готовы определить меру на многообразиях.

Пусть $M \subseteq \mathbb{R}^n$ - $k$-мерное $C^1$-гладкое многообразие, заданное параметрически, т.е. существует $\varphi : U \subseteq \mathbb{R}^k \to \mathbb{R}^n$, такое что $\varphi \in C^1$ и $M=\varphi(U)$. 

\begin{equation*}
\varphi = 
\begin{cases}
	x_1 = \varphi_1(t_1, \ldots, t_k) \\
	\vdots \\
	x_n = \varphi_n(t_1, \ldots, t_k)
\end{cases}
\quad 
(t_1, \ldots, t_k) \in U
\end{equation*}

Определим меру $k$-мерной площади $S^k$ на параметрически заданном многообразии $M$.

\begin{definition}
	Пусть $E \subseteq U \to \mathbb{R}^k$ - измеримо по $|.|_k$, тогда $\varphi(E)$ назовем измеримым по $S^k$ и будем вычислять его меру как $S^k(\varphi(E)) := \int\limits_{E} J_{\varphi}(t)dt$, где $J_{\varphi}(t)=\sqrt{\det D \varphi^*(t) D \varphi(t)}$.
\end{definition}

Внимательный читатель задастся вопросом: а не зависит ли наша мера от параметризации многообразия?

\begin{lemma}
	Пусть  $\varphi : U \subseteq \mathbb{R}^k \to \mathbb{R}^n$ и  $\psi : V \subseteq \mathbb{R}^k \to \mathbb{R}^n$ - различные параметризации многообразия, такие что $\rank D \varphi = \rank D \psi = k$. Тогда $\int\limits_{U} J_{\varphi}(t)dt = \int\limits_{V} J_{\psi}(t)dt$.
\end{lemma}

\begin{proof}
	Рассмотрим $\psi^{-1} \circ \varphi$ - отображение между $U$ и $V$.
	
	Очевидно, что $\psi^{-1} \circ \varphi$ является биекцией и $\det D \psi^{-1} \circ \varphi \not= 0$. Следовательно, $\psi^{-1} \circ \varphi$ -- $C^1$-диффеоморфизм.
	
	Сделаем замену переменных $y = \psi^{-1} (\varphi (x))$ в интеграле:
	
	\begin{multline*}
		\int\limits_{V} \sqrt{\det D \psi^* (y) D \psi (y)} dy = 
		\int\limits_{U} \sqrt{\det D \psi^* (\psi^{-1} \circ \varphi (x)) D \psi (\psi^{-1} \circ \varphi (x)) } \\ 
		|\det D \psi^{-1} \circ \varphi (x)|dx = \int\limits_{U} \sqrt{\det D \psi^* (\psi^{-1} \circ \varphi (x)) D \psi (\psi^{-1} \circ \varphi (x)) } \\ \sqrt{\det D (\psi^{-1} \circ \varphi)^* (x) \det D \psi^{-1} \circ \varphi (x)} dx
	\end{multline*}
	
	Заметим, что: 
	\begin{equation*}
		D \psi(\psi^{-1} \circ \varphi) = D \psi (\psi^{-1} \circ \varphi) \cdot D (\psi^{-1} \circ \varphi) = D \varphi
	\end{equation*}
	
	% и $D \psi^*(\psi^{-1} \circ \varphi) = D \psi^* (\psi^{-1} \circ \varphi) \cdot D (\psi^{-1} \circ \varphi) = D \varphi^*$%.
	
	Осталось применить то, что произведение определитей равно определителю произведения и подставить это равенство в интеграл.
\end{proof}

Рассмотрим некоторые свойства меры $S^k$:

\begin{enumerate}
	\item Счетная аддитивность. 
	
	Пусть $\{M_i\}_{i \in N}$ -- не более чем счетный дизъюнктивный набор множеств, тогда $S^k(\bigcup M_i) = \sum\limits_{i} S^k(M_i)$.
	
	\item Меру можно доопределить для кусочно-гладкого многообразия, так как мера множества размерности меньше $k$ равна нулю в мере $S^k$.
\end{enumerate}

\begin{example}
	Вывести формулу длины кривой $\gamma : [a, b] \to \mathbb{R}^n$ с помощью меры $S^k$ и формулы Бине-Коши. 
\end{example}

\begin{proof}[Решение]
	\begin{equation*}
	\gamma(t) = 
	\begin{pmatrix}
	x_1(t) \\
	\vdots \\
	x_n(t)
	\end{pmatrix}
	\quad	
	D \gamma(t) = 
	\begin{pmatrix}
	x_1'(t) \\
	\vdots \\
	x_n'(t)
	\end{pmatrix} 
	\text{ - вектор скорости}
	\end{equation*}
	
	\begin{equation*}
	\sqrt{\det D \gamma^* (t) D \gamma (t)} = \sqrt{{x'}_1^2 + \ldots + {x'}_n^2} = |\gamma'(t)|
	\end{equation*}
	
	\begin{equation*}
	l(\gamma) = \int\limits_{a}^{b} |\gamma'(t)|dt
	\end{equation*}
\end{proof}

% Лекция 01.03.19

\begin{definition}
	Мера угла -- длина дуги окружности с центром в начале угла.
\end{definition}


\subsection{Площадь графика функции}


Пусть $f: U \to \mathbb{R}^n \in C^1$, где $U \subseteq \mathbb{R}^n$ её график -- $n$-мерное многообразие 
$\Gamma_f = \{ (\bar{x}, f(x)) \in \mathbb{R}^{n + 1} \}.$

Чтобы найти $S^k$ надо параметризовать график функции. 
Пусть 
\begin{equation*}
\varphi:
	\begin{cases}
	x_1 = x_1, \\
	\ldots \\
	x_n = x_n, \\
	y = f(x_1, \ldots, x_n).
	\end{cases}
\end{equation*}
-- параметризация графика.
Тогда $S^k(\Gamma_f) = \int_U J_{\varphi}(x) dx.$

Посчитаем $D\varphi$. 

\[
	D\varphi = 
\begin{pmatrix}
	1 & & \\
	& \ddots & \\
	& & 1 \\\hline
	\frac{\partial f}{\partial x_1} &
	\ldots & 
	\frac{\partial f}{\partial x_n}
	
\end{pmatrix}_{n \times (n+1)}
\]

Нам нужно посчитать определитель матрицы $\det D\varphi^*
D\varphi$. Если мы будем считать «в лоб»:

\begin{equation*}
	D\varphi^* D\varphi = E +
	\left( \frac{\partial f}{\partial x_i} \cdot
	\frac{\partial f}{\partial x_j} \right)_{i, j}
\end{equation*}

Получилась довольно сложная конструкция.
Определитель проще вычислить по формуле Бине-Коши. 
\[\det D\varphi^*D\varphi = 1 + f_{x_1}^2 + f_{x_2}^2 + \ldots
+ f_{x_n}^2 = 1 + |\nabla f|^2\]
Отсюда получаем, что 
\begin{equation*} \label{SkFormulas}
	S^k(\Gamma_f) = \int_U \sqrt{1 + |\nabla f(x) |^2}\ dx 
\end{equation*}

Свойство формулы \ref{SkFormulas}:
\begin{itemize}
	 \item 
	 $S^k(\lambda M) = \lambda^k S^k(M)$
	 \begin{proof}
	 TODO %TODO
	 \end{proof}
	 
\end{itemize}

\begin{example}[Вывод частной формулы из общей]
	Пусть $f: [a, b] \to \mathbb{R}_+$
	
	\begin{center}
	\begin{tikzpicture}[el/.style args={#1,#2}{draw,ellipse,minimum width=#1, minimum height=#2},outer sep=0pt,>=latex']
	
	\draw[->] (-1, -0.05) -- (4, -0.05);
	\draw[->] (-0.5,-1.5) -- (-0.5,2);

	\coordinate [label=left:\textcolor{blue}{\textit{y}}]
	(Y) at (-0.5,2);
	\coordinate [label=right:\textcolor{blue}{\textit{x}}]
	(Y) at  (4,-0.05);
	arc(0:-90:1 and -1) -- (1, 1) node[midway, right, color =black]{} arc(270:360:1 and 1) ;
	
	\node(el-1) [el={.75cm,2cm}]at (0,0){};
	
	\node(el-2) [el={.75cm,2cm},fill=green!5]at (3,0){} (el-2.90)node [above right]{};
	
	\path [fill=white] (el-1.87)rectangle([shift={(1cm,-.1cm)}]el-1.-87);
	\draw (3.95, -0.05) -- (3, -0.05);
	\draw (0, -0.05) -- (1.1, -0.05);
	\draw (el-1.87)to[bend right=20](el-2.93) (el-1.-87)to[bend left=20](el-2.-93);
	
	\begin{scope}
	\path[clip](1,-1)rectangle(1.5,1);
	\node(el-3) [el={.6cm,1.4cm},densely dashed,thin]at (1.5,0){};
	\end{scope}
	
	\draw[densely dashed,thin] (el-1.-160)to[bend left=10](el-2.-160);	
	
	\end{tikzpicture}
	\end{center}

	-- поверхность, полученная вращением кривой относительно оси $Ox$.
	
	Для того, чтобы вывести формулу, нам нужно параметризовать поверхность.
	Должно быть два параметра $(x, \varphi)$.
	Воспользуемся цилиндрической системой координат: 
	\begin{equation*}
		\begin{cases}
		x = x, \\
		y = f(x)\cos \varphi, \\
		z = f(x)\sin \varphi.
		\end{cases}
	\end{equation*}
	
	Вывод формулы: TODO. %TODO
\end{example}

\section{Криволинейные интегралы}
\subsection{Криволинейные интегралы I-рода}

\begin{definition}
	Пусть $M$ -- $n$-мерное дифференцируемое многообразие, задана функция
	$f: M \to \mathbb{E}$ -- измеримая по $S^k$. Тогда интегралом по поверхности назовем 
	\[ \int_M f\ dS^k \]
\end{definition}

Чтобы взять интеграл по поверхности нам нужно: 
\begin{enumerate}
	\item 
	надо выбрать параметризацию
	
	\item 
	подставить параметризацию в интеграл
\end{enumerate}

Если мы выберем некоторую параметризацию $M = \varphi(U)$, то $S^k(M) = \int_U J_{\varphi}(x)dx$, получаем,
 \[ \int_M f(y)dS^k = \int_U f(\varphi(x))\cdot J_\varphi (x)dx \]
 
 
 Свойства интеграла по поверхности
 \begin{enumerate}
 	\item 
 	линейность: если $f, g: M \to \mathbb{E}$ и $\alpha, \beta \in \mathbb{R}$, то 
 	\[ \int_M (\alpha f + \beta g) dS^k = \alpha \int_M f dS^k + 
 	\beta\int_M g dS^k. \]
 	
 	\item 
 	монотонность: если $f, g: M \to \mathbb{E}$ и $f \leq g$, то
 	\[ \int_M f dS^k \leq \int_M g dS^k. \]
 	
 	\item
 	аддитивность по области определения: если $f: M \to \mathbb{E}$ 
 	и $M_1 \cap M_2 = \emptyset$, то 
 	\[ \underset{M_1 \cup M_2}{\int} f dS^k = 
 	\underset{M_1}{\int} f dS^k +\underset{M_2}{\int}  f dS^k. \]
 	
 	\item 
 	ограниченность: если $f: M \to \mathbb{E}$, то
 	\[ \left| \int_M f dS^k \right| \leq \int_M |f| dS^k.  \]
 	
 \end{enumerate}

\subsection{Объем шара и площадь сферы} %07.03.19

Введем сфеерическую систему координат в $\mathbb{R}^k$:

\begin{equation*}
	u = 
	\begin{cases}
		x_1 = r \cos \varphi \cos \theta_1 \cos \theta_2 \cdots \cos \theta_{n-2} \\
		x_2  = r \sin \varphi \cos \theta_1 \cos \theta_2 \cdots \cos \theta_{n-2} \\
		x_3 = r \sin \varphi \cos \theta_2 \cdots \cos \theta_{n-2} \\
		\vdots \\
		x_n = r \sin \theta_2 \cdots \cos \theta_{n-2} \\
		
		r \geq 0 \quad \varphi \in [0, 2\pi] \quad \theta_i \in [-\frac{\pi}{2}, \frac{\pi}{2}]
	\end{cases}
\end{equation*}

Заметим, что $u(r, \varphi, \theta_1, \ldots, \theta_{n-2})$ - параметризация шара, а $\tilde{u}(\varphi, \theta_1, \ldots, \theta_{n-2})=u|_{r=const}$ - параметризация сферы.

Обозначим $n$-мерный шар радиуса $r$ как $B_r$. Соотвественно $S_r$ - $(n-1)$-мерная сфера радиуса $r$.

Вычислим якобианы $J_u$ и $J_{\tilde{u}}$ этих параметризаций. Нам известно, что $J_u = |\det Du|$ и $J_{\tilde{u}} = |\det D \tilde{u}|$. 

Рассмотрим набор векторов $\{u_r, u_{\varphi}, u_{\theta}, \ldots, u_{\theta_{n-2}} \}$, где $u_s=\{ \frac{\partial x_1}{\partial s}, \ldots, \frac{\partial x_n}{\partial s} \}$. Нетрудно проверить, что этот набор является ортогональным. Следовательно, объем параллепипеда, который натянут на этот набор можно вычислить как произведение длин векторов набора.

\begin{equation*}
	J_u =|u_r||u_{\varphi}||u_{\theta}|\cdots|u_{\theta_{n-2}}| \quad
		J_{\tilde{u}} =|u_{\varphi}||u_{\theta}|\cdots|u_{\theta_{n-2}}|
\end{equation*}

Вычислим длины этих векторов.

\begin{align*}
	& |u_r| =  1 \\
	& |u_{\varphi}| = r \cos \theta_1 \cos \theta_2 \cdots \cos \theta_{n-2} \\
	& |u_{\theta_1}| = r \cos \theta_2 \cdots \cos \theta_{n-2} \\
 & 	\ldots\\
	& |u_{\theta_{n-3}}|  = r \cos \theta_{n-2} \\
	& |u_{\theta_{n-2}}| = r
\end{align*}

Из того, что $|u_r|=1$ следует, что $J_u = J_{\tilde{u}}$.

Теперь мы можем записать конкретное выражение для $J_u$:

\begin{equation*}
	J_u = r^{n-1} \cos \theta_1 \cos^2 \theta_2 \cdots \cos^{n-2} \theta_{n-2}
\end{equation*}

Из этого следуют формулы объема шара и площади сферы:

\begin{align*}
	|B_R| = \int\limits_0^R dr \int\limits_{0}^{2\pi} d \varphi \int\limits_{-\frac{\pi}{2}}^{\frac{\pi}{2}} d \theta_1 \cdots \int\limits_{-\frac{\pi}{2}}^{\frac{\pi}{2}} d \theta_{n-2} = w_n R^n \\
	S^{n-1}(S_r) = \int\limits_{0}^{2\pi} d \varphi \int\limits_{-\frac{\pi}{2}}^{\frac{\pi}{2}} d \theta_1 \cdots \int\limits_{-\frac{\pi}{2}}^{\frac{\pi}{2}} d \theta_{n-2}
\end{align*}

Так как $J_u = J_{\tilde{u}}$, можно получить другое выражение для объема шара:

\begin{equation*}
	|B_r|=\int\limits_{0}^{R} S^{n-2}(S_r) dr
\end{equation*}

То есть, чтобы найти объем шара нужно вычислить площади сфер, которые в нем содержаться. Так же площадь сферы можно представить ввиде объемов шаров:

\begin{equation*}
	S^{n-1}(S_r) = (w_n r^n)'_r=r w_n r^{n-1}
\end{equation*}

\subsection{Формула коплощади} 

Пусть $\varphi : U \subseteq \mathbb{R}^n \to R$. Потребуем, чтобы $\nabla \varphi \not= 0$ (т. е. $\rank D \varphi = k$ - максимальный). 

Уравнение $\varphi(x) = 0$ задает поверхность в $U$. Эту поверхность можно так же задать как $\varphi^{-1}(0)$. Из этого получаем:

\begin{equation*}
	\int\limits_{a}^{b} S^{n-1}(\varphi^{-1}(t)) dt = \int\limits_{U}^{} J_{\varphi} (x) dx = \int_U |\nabla \varphi| (x) dx
\end{equation*}

\begin{theorem}[Формула коплощади]
	Пусть $\varphi : U \subset \mathbb{R}^n \to \mathbb{R}^k \in C^1$, такая, что $\rank (D \varphi) = k$, тогда верна формула коплощади
	
	\begin{equation*}
		\int\limits_{U}^{} f(x) J_{\varphi}(x) dx = \int\limits_{\mathbb{R}^k}^{}dt \int\limits_{\varphi^{-1}(t)} f(\varphi(t)) dS^{k-1}
	\end{equation*} 
	
	, где 
	
	\begin{equation*}
		J_{\varphi(x)} = \sqrt{\det D \varphi (x) \det D \varphi^* (x)} = \sqrt{\det (\langle \nabla \varphi_i, \nabla \varphi_j \rangle)}
	\end{equation*}
\end{theorem}

\begin{proof}
	Пусть $x_0 \in U$. Мы знаем, что $\rank (\frac{\partial \varphi_i}{\partial x_j}) = k$ - максимальный. Следовательно, в матрице $D \varphi$ есть $k$ линейно-независимых столбоцов. Для простоты будем считать, что это $k$ последних столбцов.
	
	По теореме о выпрямлении, существует $C^1$-диффеоморфизм $\varPhi : V \to W$, где $V$ - окрестность $x_0$, $W$ - окрестность нуля, такая что:
	
	\begin{equation*}
		\varPhi 
		\begin{pmatrix}
			x \\
			z
		\end{pmatrix}
		=
		\begin{pmatrix}
			x \\
			h(x, z)
		\end{pmatrix}
		=
		\begin{pmatrix}
			x \\
			y
		\end{pmatrix}
	\end{equation*}
	
	Выполним замену переменных в интеграле и воспользуемся формулой Фубини:
	
	\begin{align*}
		\int\limits_{U} f(x,y) J_{\varphi} (x, y) dx dy = \int\limits_{\varPhi^{-1}(U)} f(\varPhi (x, z)) J_{\varphi} (\varPhi (x, z)) J_{\varPhi(x, z)} dx dy = \\
		\int\limits_{\mathbb{R}^k} dz \int\limits_{\varphi^{-1}(U) \cap \mathbb{R}^{n-k}} f(\varPhi (x, z)) J_{\varphi} (\varPhi (x, z)) J_{\varPhi(x, z)} dx
	\end{align*}
	
	Заметим, что $\varPhi^{-1}_{z(x)} = \varPhi^{-1}(x, z)$ при фиксированом $z$ является поверхностью. Возьмем $s=\varPhi^{-1}_z(x)$, тогда
	
	\begin{equation*}
		\int\limits_{U \cap \varphi^{-1}(z)} g(s) dS^{n-k} = \int\limits_{\varphi(U) \cap \mathbb{R}^{n-k}_z} g(\varPhi_z^{-1}(x)) J_{\varPhi^{-1}_z}(x) dx
	\end{equation*}
	
	Теперь нужно подставить это в прошлое уравнение.
	
	\begin{equation*}
	\int\limits_{\mathbb{R}^k} dz \int\limits_{\varphi^{-1}(U) \cap \mathbb{R}^{n-k}} f(\varPhi (x, z)) J_{\varphi} (\varPhi (x, z)) J_{\varPhi(x, z)} dx = \int\limits_{\mathbb{R}^k} dz \int\limits_{U \cap \varphi^{-1}(z)} f(s) \frac{J_{\varphi} J_{\varPhi}}{J_{\varPhi^{-1}_z}}
	\end{equation*}
	
	Для того, чтобы закончить доказательство, нужно лишь доказать, что:
	
	\begin{equation*}
		\frac{J_{\varphi} J_{\varPhi}}{J_{\varPhi^{-1}_z}} = 1
	\end{equation*}
	
	(TODO: продолжение следует)
\end{proof}

\begin{corollary}
	Если $P_r : \mathbb{R}^n \to \mathbb{R}^k$ - проекция, тогда 
	
	\begin{equation*}
		\int\limits_{U}^{} f(x) dx = \int\limits_{\mathbb{R}^k}^{}dt \int\limits_{\mathbb{R}_t^{n-k}} f(y) dy
	\end{equation*}
	
	, где $\mathbb{R}_t^{n-k} = \{(y, s) : s=t\}$ - $(n-k)$-мерная плоскость (TODO: а это точно следствие?).
\end{corollary}

\section{Введение в векторный анализ}
\subsection{Дифференциальные формы}

\begin{definition}	Векторным полем на многообразии $M$ называется функция
	 $F : M \to F(x)$, такая что $F(x) \in T_{x}M$.
\end{definition}

Для того, чтобы выяснить, как замена переменных влияет на векторное поле, введем оператор переноса.

\begin{definition}
	Пусть $\varphi : U \to V$ - $C^1$-диффеоморфизм. Тогда оператором переноса  назовем $\varphi^{*}$ и определим результат его действия на функцию $f : V \to \mathbb{E}$ как фукнцию $\varphi^{*}f : U \to \mathbb{E}$, такую, что $\varphi^{*}f(x)=f(\varphi(x))=(f \circ \varphi)(x)$.
\end{definition}

Выясним как оператор переноса действует на векторное поле. Пусть $v : V \to TV$ - векторное поле, тогда $\varphi^{*}v : U \to TU$ и $\varphi^{*}v(x)=D\varphi_{\varphi(x)} \langle v(\varphi(x)) \rangle$.

Свойства оператора переноса:
\begin{enumerate}
	\item 
	линейность: $\forall \alpha, \beta \in \mathbb{R} \; \forall f,g$ - функции $\forall u,v$ - векторные поля.	
	
	\begin{equation*}
		\varphi^{*}(\alpha f + \beta g)=\alpha\varphi^{*}f + \beta\varphi^{*}g \quad \varphi^{*}(\alpha u + \beta v) = \alpha \varphi^{*}u + \beta\varphi^{*}v
	\end{equation*}
	
	\item 
	мультипликативность: пусть $f : V \to \mathbb{R}$, $v : V \to TV$, $(f \circ v)(g)=f(g)\vec{v}(g)$. Тогда, если $\varphi : U \to V$ - $C^1$-диффеоморфизм, то $\varphi^{*}(f \vec{v})=\varphi^{*}f \cdot \varphi^{*}v$.
	
	\item перенос композиции является произведением переносов: пусть $\varphi : U \to V$, $\psi : U \to V$ - $C^1$-диффеоморфизмы, тогда $(\varphi \circ \psi)^{*}=\varphi^{*} \psi^{*}$.
	
	\item перестановочность с дифференциалом: $\varphi^{*}d=d \varphi^{*}$.
	
\end{enumerate}

Для доказательства последнего свойства, нам нужно ввести определение дифференциальной формы, а для этого нужно вспомнить некоторые свойства линейных отображений.

Пусть $L : \mathbb{R}^n \to \mathbb{R}$ - линейное отображение. Рассмотрим действие $L$ на вектор $v$:

\begin{equation*}
	L\langle v \rangle = L \langle v_1 e_1 + \ldots + v_n e_n \rangle = v_1 L\langle e_1 \rangle + \ldots + v_n L\langle e_n \rangle = v_1 a_1 + \ldots v_n a_n
\end{equation*}

Из этого уравнения следует то, что всякая линейная функция это скалярное произведение аргумента с некоторым постоянным вектором: $L \langle v \rangle = a \cdot v$.

Введем базис на пространстве линейных отображений $Lin(\mathbb{R}^n, \mathbb{R}) \simeq \mathbb{R}^n$. 

Набор функций $dx_1, \ldots, dx_n : \mathbb{R}^n \to \mathbb{R}$, таких что $dx_j(v_1, \ldots, v_n)=v_j$, является базисом в $Lin(\mathbb{R}^n, \mathbb{R})$. Следовательно, $L \langle v \rangle = a_1 v_1 + \ldots + a_n v_n = a_1 dx_1 + \ldots + a_n dx_n$.

Обозначим за $\Lambda^k(\mathbb{R}^n)$ пространство алгебраических форм степени $k$ над $\mathbb{R}^n$. В частности $\Lambda^0(\mathbb{R}^n)=\mathbb{R}$ и $\Lambda^1(\mathbb{R}^n)=Lin(\mathbb{R}^n, \mathbb{R})$.

\begin{definition}
	Дифференциальной формой степени $k$ (сокращенно $k$-формой) на $U \subseteq \mathbb{R}^n$ будем называть $w : U \to \Lambda^k(\mathbb{R}^k)$.
\end{definition}

\begin{lemma}
	Существует так называемый дуализм между $1$-формами и векторными полями, так как каждая $1$-форма изоморфна некоторому векторному полю.
\end{lemma}

\begin{proof}
	Рассмотрим некоторую $1$-форму $w(x)$, тогда $w(x)=a_1(x) dx_1 + \ldots a_n(x) dx_n$. Пусть $v(x) = (a_1(x), \ldots, a_n(x))$, тогда $w(x) \langle u \rangle = v(x) \cdot u$. 
\end{proof}

Дифференциал функции так же является $1$-формой. Так что стоит задасться вопросом: а не все ли $1$-формы являются дифференциалом некоторой функции? Пример ниже говорит, что ответ на этот вопрос - нет.

\begin{example}
	$w=xdy$ - $1$-форма, но не дифференциал.
\end{example}

\begin{proof}
	Допустим, что $w=df=f_x dx + f_y dy$. Тогда $f_x = 0$ и $f_y = x$. Из курса мы знаем, что для любой функции $f_{xy}=f_{yx}$. Проверим, так ли это в нашем случае. Получаем $f_{xy} = 0 \not = 1 = f_{yx}$. Получили противоречие.
\end{proof}

Рассмотрим как перейти к полярным координатам в форме 	$w=xdy$. Пусть $x = r \cos\varphi$ и $y = r \sin\varphi$, тогда $\varphi^* w = r\cos\varphi d(r\sin\varphi) = r\cos\varphi(\sin\varphi dr + r\cos\varphi d\varphi)=r\sin\varphi\cos\varphi dr + r^2 \cos^2 \varphi d \varphi$.

Опеределим теперь оператор переноса для $1$-форм.

\begin{definition}
	Пусть $w$ - $1$-форма на $V$. Пусть $\varphi : U \to V \subseteq \mathbb{R}^n$ - $C^1$-диффеоморфизм. Тогда $\varphi^{*}w$ - $1$-форма на $U$ и $\varphi^{*} w(x) \langle v \rangle = w(\varphi(x)) \langle d \varphi(x) \langle v \rangle \rangle$.
\end{definition}

Теперь мы можем доказать 4 свойство оператора переноса.

\begin{lemma}[Четвертое свойство оператора переноса]
	Пусть $\varphi : U \to V$ - $C^1$-диффеоморфизм, $f : V \to \mathbb{E} \in C^1$, тогда $\varphi^{*}(d \varphi) = d (\varphi^{*} f)$. Заметим так же, что слева от равенства стоит $1$-форма, а справа $0$-форма.
\end{lemma}

\begin{proof}
	Утверждение следует из следующей цепочки равенств:
	
	\begin{align*}
		\varphi^{*}(df)(x) \langle v \rangle  = df (\varphi (x)) \langle d\varphi(x) \langle v \rangle \rangle = df (\varphi (x)) \circ d \varphi(x) \langle v \rangle =\\ = d (f \circ \varphi )(x) \langle v \rangle = d(\varphi^{*}f)(x) \langle v \rangle
	\end{align*}
\end{proof}

\begin{example}[Работа векторного поля вдоль кривой]
	Рассмотри одно из физических приложений дифференциальных форм. Мы знаем, что работа силы вычисляется по формуле $A = \vec(F) \cdot \vec{l}$. То есть силу можно рассматривать как дифференциальную форму $A = w_g \langle l \rangle$. А теперь представим, что нам нужно посчитать работу вдоль кривой, где сила не постоянна на всех точках кривой. Получаем $A = \int\limits_{\gamma} \vec{g}(x) \cdot \vec{r}(x) d l(x)$.
\end{example}

\end{document}

